# Форматы входных данных

Компонент принимает JSON-строку или объект, который затем нормализуется в один из типов:

- `value` — простые значения (строки, числа, булевы, `null`).
- `structure` — объект с полями.
- `table` — табличная часть с колонками и строками.

Ниже описаны поддерживаемые форматы.

## 1. Обычный JSON-объект (structure)

Если передать обычный объект, он считается структурой. Каждый ключ — поле, значение может быть:

- простым значением,
- вложенным объектом,
- объектом типа `table`,
- объектом типа `structure`.

Пример:

```json
{
  "name": "Документ",
  "meta": { "type": "Поступление", "number": 42 },
  "table": {
    "type": "table",
    "columns": ["Номенклатура", "Количество"],
    "rows": [
      { "id": 1, "cells": { "Номенклатура": "Товар A", "Количество": 2 } },
      { "id": 2, "cells": { "Номенклатура": "Товар B", "Количество": 1 } }
    ]
  }
}
```

## 2. Явная структура (type = "structure")

Явный формат структуры используется, если нужно хранить поля в `fields`.

```json
{
  "type": "structure",
  "fields": {
    "name": "Документ",
    "meta": { "type": "Поступление", "number": 42 }
  }
}
```

## 3. Таблица (type = "table")

Таблица описывается объектом с типом `table`:

```json
{
  "type": "table",
  "name": "Товары",
  "columns": ["Номенклатура", "Количество"],
  "rows": [
    { "id": 1, "cells": { "Номенклатура": "Товар A", "Количество": 2 } },
    { "id": 2, "cells": { "Номенклатура": "Товар B", "Количество": 1 } }
  ]
}
```

Поля таблицы:

- `type`: обязателен, значение `table`.
- `name` или `title`: имя таблицы (опционально).
- `columns`: список колонок. Если не задан, формируется автоматически по ключам ячеек.
- `rows`: массив строк.

Форматы строк:

- Строка как объект с `cells`:
  - `id`/`$id`/`key` — идентификатор строки (опционально).
  - `cells` — объект `колонка -> значение`.
- Строка как объект без `cells`: любые поля считаются ячейками.
- Строка как массив: значения сопоставляются по порядку колонок.

Идентификатор строки:

- Если есть `id`/`$id`/`key`, используется он.
- Если нет, используется порядковый номер строки (с 1).

## 4. Значения (value)

Простые значения не разворачиваются в структуру. Массивы считаются значением (не структурой).

Пример:

```json
["a", "b", "c"]
```

## Примечания

- В ячейках таблицы допускаются вложенные структуры и таблицы.
- `null` и `undefined` отображаются как пустые значения.
